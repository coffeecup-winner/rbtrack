<% provide(:title, "#{@issue.project.name} # #{@issue.subject}") %>
<h1><span class="id">#<%= @issue.id %></span> <%= @issue.subject %></h1>
<div id="issue">
  <div class="row">
    <div class="span6">
      <span id="project">Project: <%= link_to @issue.project.name, @issue.project %></span>
    </div>
  </div>
  <div class="row">
    <div class="span6">
      <span id="user">User: <%= link_to @issue.user.name, @issue.user %></span>
    </div>
  </div>
  <div></div>
  <div class="row">
    <div class="span12">
      Status: <%= Status.to_string(@issue.status) %>
    </div>
  </div>
  <div class="row">
    <div class="span12">
      Description:
      <p><%= @issue.description %></p>
    </div>
  </div>
  <% @is_admin = !current_user.nil? && current_user.admin? %>
  <% if @issue.user == current_user || @issue.project.users.include?(current_user) || @is_admin %>
    <% if @issue.closed? %>
      <%= link_to 'Reopen issue', issue_path(@issue, reopen: true), class: 'btn btn-primary', method: :put %>
    <% else %>
      <%= link_to 'Edit issue', edit_issue_path(@issue), class: 'btn btn-primary' %>
      <%= link_to 'Close issue', issue_path(@issue, close: true), class: 'btn btn-danger', method: :put %>
    <% end %>
  <% end %>
  <% if @is_admin %>
    <%= link_to 'Remove issue', issue_path(@issue), class: 'btn btn-danger', method: :delete %>
  <% end %>
</div>